
https://bugzilla.redhat.com/show_bug.cgi?id=690911

http://svn.php.net/viewvc/?view=revision&amp;revision=306493

--- php-5.3.3/ext/zip/zip_stream.c.cve1470
+++ php-5.3.3/ext/zip/zip_stream.c
@@ -139,6 +139,7 @@ php_stream *php_stream_zip_open(char *fi
 			self->stream = NULL;
 			self->cursor = 0;
 			stream = php_stream_alloc(&php_stream_zipio_ops, self, NULL, mode);
+			stream->orig_path = estrdup(path);
 		} else {
 			zip_close(stream_za);
 		}
