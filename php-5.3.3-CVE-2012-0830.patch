
https://bugzilla.redhat.com/show_bug.cgi?id=786686

--- php-5.3.3/main/php_variables.c.cve0830
+++ php-5.3.3/main/php_variables.c
@@ -198,6 +198,9 @@ PHPAPI void php_register_variable_ex(cha
 						MAKE_STD_ZVAL(gpc_element);
 						array_init(gpc_element);
 						zend_symtable_update(symtable1, escaped_index, index_len + 1, &gpc_element, sizeof(zval *), (void **) &gpc_element_p);
+					} else {
+						efree(var_orig);
+						return;
 					}
 				}
 				if (index != escaped_index) {
